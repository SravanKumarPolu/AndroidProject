# Android Testing Guide ğŸ§ª

## Overview
This guide covers building an APK and testing Android shortcuts and deep linking.

---

## ğŸ“¦ Part 1: Build APK

### Option A: EAS Build (Recommended - Cloud Build)

#### 1. Install EAS CLI
```bash
npm install -g eas-cli
```

#### 2. Login to Expo
```bash
eas login
```

#### 3. Configure EAS Build
```bash
eas build:configure
```

This creates `eas.json`. Update it:
```json
{
  "build": {
    "development": {
      "developmentClient": true,
      "distribution": "internal"
    },
    "preview": {
      "android": {
        "buildType": "apk"
      }
    },
    "production": {}
  }
}
```

#### 4. Build APK
```bash
eas build --platform android --profile preview
```

**Time:** ~15-20 minutes  
**Output:** Download link in terminal

---

### Option B: Local Build (Requires Android Studio)

#### 1. Install Android Studio
- Download from https://developer.android.com/studio
- Install Android SDK (API 33+)
- Set `ANDROID_HOME` environment variable

#### 2. Generate Native Code
```bash
npx expo prebuild --platform android
```

#### 3. Build APK
```bash
cd android
./gradlew assembleRelease
```

**Output:** `android/app/build/outputs/apk/release/app-release.apk`

---

### Option C: Expo Go (Quick Testing - No APK)

For quick testing without building:
```bash
npm start
# Scan QR code with Expo Go app
```

**Limitation:** Shortcuts won't work in Expo Go (requires native build)

---

## ğŸ”— Part 2: Test Android Shortcuts

### Prerequisites
- âœ… APK installed on Android device (not Expo Go)
- âœ… Android 7.1+ (API 25+)

### Test Steps

#### 1. Long-Press App Icon
1. Find **ImpulseVault** icon on home screen
2. **Long-press** the icon (hold for 1-2 seconds)
3. Shortcut menu should appear

#### 2. Verify Shortcut
- âœ… **"Quick Add"** shortcut should be visible
- âœ… Icon should display correctly
- âœ… Tap the shortcut

#### 3. Expected Behavior
- âœ… App opens directly to **Quick Add** screen
- âœ… No navigation to home screen first
- âœ… Quick Add form is ready to use

### Troubleshooting

**Shortcut not appearing:**
- âœ… Ensure APK is built (not Expo Go)
- âœ… Check Android version (7.1+)
- âœ… Reinstall app: `adb uninstall com.impulsevault.app && adb install app.apk`
- âœ… Clear app data and reinstall

**Shortcut opens wrong screen:**
- âœ… Check `app/_layout.tsx` deep link handler
- âœ… Verify `app.json` shortcut configuration

---

## ğŸ”— Part 3: Test Deep Linking

### Method 1: ADB Command (Recommended)

#### Test Quick Add Deep Link
```bash
adb shell am start -W -a android.intent.action.VIEW -d "impulsevault://quick-add" com.impulsevault.app
```

**Expected:**
- âœ… App opens (or comes to foreground)
- âœ… Navigates directly to Quick Add screen
- âœ… No intermediate screens

#### Test Other Deep Links (Future)
```bash
# Review impulse
adb shell am start -W -a android.intent.action.VIEW -d "impulsevault://review-impulse/123" com.impulsevault.app

# Home
adb shell am start -W -a android.intent.action.VIEW -d "impulsevault://" com.impulsevault.app
```

---

### Method 2: Browser/ADB Intent

#### From Browser (Android)
1. Open browser on device
2. Navigate to: `impulsevault://quick-add`
3. Tap "Open in app" if prompted
4. App should open to Quick Add screen

#### From ADB
```bash
adb shell am start -a android.intent.action.VIEW -d "impulsevault://quick-add"
```

---

### Method 3: Test App (Optional)

Create a simple test app or use:
```bash
# Install a deep link tester app from Play Store
# Or use: https://play.google.com/store/apps/details?id=com.manoj.dlt
```

---

## âœ… Testing Checklist

### Shortcuts
- [ ] Long-press app icon shows "Quick Add" shortcut
- [ ] Shortcut icon displays correctly
- [ ] Tapping shortcut opens Quick Add screen
- [ ] No intermediate navigation screens
- [ ] Quick Add form is functional

### Deep Linking
- [ ] `impulsevault://quick-add` opens Quick Add screen
- [ ] Deep link works when app is closed
- [ ] Deep link works when app is in background
- [ ] Deep link works when app is in foreground
- [ ] No crashes or errors

### Integration
- [ ] Shortcut and deep link both work
- [ ] Navigation is smooth
- [ ] No duplicate screens
- [ ] Back button works correctly

---

## ğŸ› Common Issues & Fixes

### Issue: Shortcut Not Appearing
**Fix:**
1. Ensure native build (not Expo Go)
2. Check `app.json` has shortcuts configured
3. Rebuild APK
4. Clear app data: `adb shell pm clear com.impulsevault.app`

### Issue: Deep Link Not Working
**Fix:**
1. Check `app.json` has `"scheme": "impulsevault"`
2. Verify `app/_layout.tsx` has deep link handler
3. Check AndroidManifest.xml (auto-generated by Expo)
4. Test with ADB command first

### Issue: Wrong Screen Opens
**Fix:**
1. Check `Linking.parse()` in `app/_layout.tsx`
2. Verify path matching logic
3. Check route names match

### Issue: App Crashes on Deep Link
**Fix:**
1. Check console logs: `adb logcat | grep ReactNativeJS`
2. Verify all imports are correct
3. Check for missing dependencies

---

## ğŸ“± Quick Test Commands

```bash
# Install APK
adb install app-release.apk

# Uninstall
adb uninstall com.impulsevault.app

# Test deep link
adb shell am start -W -a android.intent.action.VIEW -d "impulsevault://quick-add" com.impulsevault.app

# View logs
adb logcat | grep -E "ReactNativeJS|ExpoLinking"

# Clear app data
adb shell pm clear com.impulsevault.app
```

---

## ğŸ¯ Expected Results

### âœ… Success Indicators

**Shortcuts:**
- Long-press â†’ "Quick Add" appears
- Tap â†’ Opens Quick Add screen instantly

**Deep Linking:**
- `impulsevault://quick-add` â†’ Opens Quick Add screen
- Works from any state (closed/background/foreground)

**User Experience:**
- Smooth navigation
- No loading delays
- Form is ready to use immediately

---

## ğŸ“ Notes

- **Expo Go:** Shortcuts won't work (requires native build)
- **Development:** Use `expo start --dev-client` for testing
- **Production:** Build APK with EAS or local build
- **Testing:** Always test on real device (emulator may have issues)

---

## ğŸš€ Next Steps

1. âœ… Build APK using EAS or local build
2. âœ… Install on Android device
3. âœ… Test shortcuts (long-press icon)
4. âœ… Test deep linking (ADB command)
5. âœ… Verify navigation works correctly
6. âœ… Document any issues found

---

**Status:** Ready for testing! ğŸ‰

